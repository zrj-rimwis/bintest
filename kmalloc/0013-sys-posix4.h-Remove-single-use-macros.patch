From 53c40b1b4fc0ed82642e0a57bb37020b2f544510 Mon Sep 17 00:00:00 2001
From: zrj <rimvydas.jasinskas@gmail.com>
Date: Tue, 22 Oct 2019 17:44:26 +0300
Subject: [PATCH 13/26] <sys/posix4.h>: Remove single use macros.

 Use kmalloc()/kfree() directly.
---
 sys/kern/kern_sched.c | 6 ++++--
 sys/sys/posix4.h      | 3 ---
 2 files changed, 4 insertions(+), 5 deletions(-)

diff --git a/sys/kern/kern_sched.c b/sys/kern/kern_sched.c
index 9e9a5552c2..8e89b75c60 100644
--- a/sys/kern/kern_sched.c
+++ b/sys/kern/kern_sched.c
@@ -56,7 +56,9 @@ struct ksched {
 int
 ksched_attach(struct ksched **p)
 {
-	struct ksched *ksched= p31b_malloc(sizeof(*ksched));
+	struct ksched *ksched;
+
+	ksched = kmalloc(sizeof(*ksched), M_P31B, M_WAITOK);
 
 	ksched->rr_interval.tv_sec = 0;
 	ksched->rr_interval.tv_nsec = 1000000000L / 10;	/* XXX */
@@ -68,7 +70,7 @@ ksched_attach(struct ksched **p)
 int
 ksched_detach(struct ksched *p)
 {
-	p31b_free(p);
+	kfree(p, M_P31B);
 
 	return 0;
 }
diff --git a/sys/sys/posix4.h b/sys/sys/posix4.h
index 08c5f01460..0c638773a0 100644
--- a/sys/sys/posix4.h
+++ b/sys/sys/posix4.h
@@ -50,9 +50,6 @@
 MALLOC_DECLARE(M_P31B);
 #endif
 
-#define p31b_malloc(SIZE) kmalloc((SIZE), M_P31B, M_WAITOK)
-#define p31b_free(P) kfree((P), M_P31B)
-
 struct proc;
 struct lwp;
 
-- 
2.23.0


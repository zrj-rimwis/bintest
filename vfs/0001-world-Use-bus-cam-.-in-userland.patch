From 91bb789618cdf96109a4e20b37f1d9bcbe201969 Mon Sep 17 00:00:00 2001
From: zrj <rimvydas.jasinskas@gmail.com>
Date: Fri, 15 Nov 2019 20:20:52 +0200
Subject: [PATCH 1/3] world: Use <bus/cam/...> in userland.

---
 lib/libcam/camlib.c                      |  8 +--
 lib/libcam/camlib.h                      | 64 ------------------------
 lib/libcam/scsi_cmdparse.c               |  7 ++-
 sbin/camcontrol/camcontrol.c             | 14 +++---
 sbin/camcontrol/modeedit.c               |  6 +--
 share/examples/scsi_target/scsi_cmds.c   |  9 ++--
 share/examples/scsi_target/scsi_target.c |  9 ++--
 share/examples/ses/Makefile.inc          |  5 +-
 usr.bin/kdump/mkioctls                   |  2 +-
 usr.sbin/mfiutil/mfi_drive.c             |  2 +-
 usr.sbin/mlxcontrol/interface.c          |  2 +-
 usr.sbin/mptutil/mpt_cam.c               |  4 +-
 usr.sbin/mptutil/mpt_drive.c             |  2 +-
 13 files changed, 33 insertions(+), 101 deletions(-)

diff --git a/lib/libcam/camlib.c b/lib/libcam/camlib.c
index febd00d96a..6bdfb7301a 100644
--- a/lib/libcam/camlib.c
+++ b/lib/libcam/camlib.c
@@ -35,10 +35,10 @@
 #include <errno.h>
 #include <ctype.h>
 
-#include <cam/cam.h>
-#include <cam/scsi/scsi_all.h>
-#include <cam/cam_ccb.h>
-#include <cam/scsi/scsi_pass.h>
+#include <bus/cam/cam.h>
+#include <bus/cam/scsi/scsi_all.h>
+#include <bus/cam/cam_ccb.h>
+#include <bus/cam/scsi/scsi_pass.h>
 #include "camlib.h"
 
 struct cam_devequiv {
diff --git a/lib/libcam/camlib.h b/lib/libcam/camlib.h
index efe30710f5..9a82765831 100644
--- a/lib/libcam/camlib.h
+++ b/lib/libcam/camlib.h
@@ -1,67 +1,3 @@
-/*
- * Copyright (c) 1997, 1998 Kenneth D. Merry.
- * All rights reserved.
- *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- * 1. Redistributions of source code must retain the above copyright
- *    notice, this list of conditions and the following disclaimer.
- * 2. The name of the author may not be used to endorse or promote products
- *    derived from this software without specific prior written permission.
- *
- * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
- * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
- * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
- * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
- * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
- * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
- * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
- * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
- * SUCH DAMAGE.
- *
- * $FreeBSD: src/lib/libcam/camlib.h,v 1.2 1999/08/28 00:04:06 peter Exp $
- * $DragonFly: src/lib/libcam/camlib.h,v 1.3 2003/08/07 21:22:38 dillon Exp $
- */
-/*
- * Buffer encoding/decoding routines taken from the original FreeBSD SCSI
- * library and slightly modified.  The original header file had the following
- * copyright:
- */
-/* Copyright (c) 1994 HD Associates (hd@world.std.com)
- * All rights reserved.
- *
- * Redistribution and use in source and binary forms, with or without
- * modification, are permitted provided that the following conditions
- * are met:
- * 1. Redistributions of source code must retain the above copyright
- *    notice, this list of conditions and the following disclaimer.
- * 2. Redistributions in binary form must reproduce the above copyright
- *    notice, this list of conditions and the following disclaimer in the
- *    documentation and/or other materials provided with the distribution.
- * 3. All advertising materials mentioning features or use of this software
- *    must display the following acknowledgement:
- * This product includes software developed by HD Associates
- * 4. Neither the name of the HD Associaates nor the names of its contributors
- *    may be used to endorse or promote products derived from this software
- *    without specific prior written permission.
- *
- * THIS SOFTWARE IS PROVIDED BY HD ASSOCIATES``AS IS'' AND
- * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
- * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
- * ARE DISCLAIMED.  IN NO EVENT SHALL HD ASSOCIATES OR CONTRIBUTORS BE LIABLE
- * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
- * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
- * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
- * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
- * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
- * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
- * SUCH DAMAGE.
- */
-
-
 #ifndef _CAMLIB_H
 #define _CAMLIB_H
 
diff --git a/lib/libcam/scsi_cmdparse.c b/lib/libcam/scsi_cmdparse.c
index b99da64b4d..8378367339 100644
--- a/lib/libcam/scsi_cmdparse.c
+++ b/lib/libcam/scsi_cmdparse.c
@@ -33,7 +33,6 @@
  * SUCH DAMAGE.
  * From: scsi.c,v 1.8 1997/02/22 15:07:54 peter Exp $
  * $FreeBSD: src/lib/libcam/scsi_cmdparse.c,v 1.3.2.1 2000/08/14 05:42:30 kbyanc Exp $
- * $DragonFly: src/lib/libcam/scsi_cmdparse.c,v 1.3 2007/11/24 01:53:50 pavalos Exp $
  */
 #include <stdlib.h>
 #include <stdio.h>
@@ -43,9 +42,9 @@
 #include <stdarg.h>
 #include <fcntl.h>
 
-#include <cam/cam.h>
-#include <cam/cam_ccb.h>
-#include <cam/scsi/scsi_message.h>
+#include <bus/cam/cam.h>
+#include <bus/cam/cam_ccb.h>
+#include <bus/cam/scsi/scsi_message.h>
 #include "camlib.h"
 
 /*
diff --git a/sbin/camcontrol/camcontrol.c b/sbin/camcontrol/camcontrol.c
index 885bb7a24b..a0d3c268f9 100644
--- a/sbin/camcontrol/camcontrol.c
+++ b/sbin/camcontrol/camcontrol.c
@@ -39,13 +39,13 @@
 #include <err.h>
 #include <libutil.h>
 
-#include <cam/cam.h>
-#include <cam/cam_debug.h>
-#include <cam/cam_ccb.h>
-#include <cam/scsi/scsi_all.h>
-#include <cam/scsi/scsi_da.h>
-#include <cam/scsi/scsi_pass.h>
-#include <cam/scsi/scsi_message.h>
+#include <bus/cam/cam.h>
+#include <bus/cam/cam_debug.h>
+#include <bus/cam/cam_ccb.h>
+#include <bus/cam/scsi/scsi_all.h>
+#include <bus/cam/scsi/scsi_da.h>
+#include <bus/cam/scsi/scsi_pass.h>
+#include <bus/cam/scsi/scsi_message.h>
 #include <sys/nata.h>
 #include <camlib.h>
 #include "camcontrol.h"
diff --git a/sbin/camcontrol/modeedit.c b/sbin/camcontrol/modeedit.c
index 335873ec90..8004b7a8a9 100644
--- a/sbin/camcontrol/modeedit.c
+++ b/sbin/camcontrol/modeedit.c
@@ -41,9 +41,9 @@
 #include <sysexits.h>
 #include <unistd.h>
 
-#include <cam/scsi/scsi_all.h>
-#include <cam/cam.h>
-#include <cam/cam_ccb.h>
+#include <bus/cam/scsi/scsi_all.h>
+#include <bus/cam/cam.h>
+#include <bus/cam/cam_ccb.h>
 #include <camlib.h>
 #include "camcontrol.h"
 
diff --git a/share/examples/scsi_target/scsi_cmds.c b/share/examples/scsi_target/scsi_cmds.c
index a37b71bfda..bcf906d010 100644
--- a/share/examples/scsi_target/scsi_cmds.c
+++ b/share/examples/scsi_target/scsi_cmds.c
@@ -26,7 +26,6 @@
  * SUCH DAMAGE.
  *
  * $FreeBSD: src/share/examples/scsi_target/scsi_cmds.c,v 1.2.2.1 2003/02/18 22:07:10 njl Exp $
- * $DragonFly: src/share/examples/scsi_target/scsi_cmds.c,v 1.2 2003/06/17 04:36:57 dillon Exp $
  */
 
 #include <stdio.h>
@@ -38,10 +37,10 @@
 #include <assert.h>
 #include <sys/types.h>
 
-#include <cam/cam.h>
-#include <cam/cam_ccb.h>
-#include <cam/scsi/scsi_all.h>
-#include <cam/scsi/scsi_targetio.h>
+#include <bus/cam/cam.h>
+#include <bus/cam/cam_ccb.h>
+#include <bus/cam/scsi/scsi_all.h>
+#include <bus/cam/scsi/scsi_targetio.h>
 #include "scsi_target.h"
 
 typedef int targ_start_func(struct ccb_accept_tio *, struct ccb_scsiio *);
diff --git a/share/examples/scsi_target/scsi_target.c b/share/examples/scsi_target/scsi_target.c
index 5867fc00fe..b8a6aa972b 100644
--- a/share/examples/scsi_target/scsi_target.c
+++ b/share/examples/scsi_target/scsi_target.c
@@ -26,7 +26,6 @@
  * SUCH DAMAGE.
  *
  * $FreeBSD: src/share/examples/scsi_target/scsi_target.c,v 1.5.2.5 2003/02/18 22:07:10 njl Exp $
- * $DragonFly: src/share/examples/scsi_target/scsi_target.c,v 1.2 2003/06/17 04:36:57 dillon Exp $
  */
 
 #include <sys/types.h>
@@ -46,10 +45,10 @@
 #include <sys/queue.h>
 #include <sys/event.h>
 #include <sys/param.h>
-#include <cam/cam_queue.h>
-#include <cam/scsi/scsi_all.h>
-#include <cam/scsi/scsi_targetio.h>
-#include <cam/scsi/scsi_message.h>
+#include <bus/cam/cam_queue.h>
+#include <bus/cam/scsi/scsi_all.h>
+#include <bus/cam/scsi/scsi_targetio.h>
+#include <bus/cam/scsi/scsi_message.h>
 #include "scsi_target.h"
 
 /* Maximum amount to transfer per CTIO */
diff --git a/share/examples/ses/Makefile.inc b/share/examples/ses/Makefile.inc
index deaf706305..e4fe660b41 100644
--- a/share/examples/ses/Makefile.inc
+++ b/share/examples/ses/Makefile.inc
@@ -1,7 +1,6 @@
 # $NetBSD: $
 # $OpenBSD: $
 # $FreeBSD: src/share/examples/ses/Makefile.inc,v 1.1 2000/02/29 05:44:06 mjacob Exp $
-# $DragonFly: src/share/examples/ses/Makefile.inc,v 1.2 2003/06/17 04:36:57 dillon Exp $
 #
 # Copyright (c) 2000 by Matthew Jacob
 # All rights reserved.
@@ -29,7 +28,7 @@
 # LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 # OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 # SUCH DAMAGE.
-# 
+#
 # Matthew Jacob
 # Feral Software
 # mjacob@feral.com
@@ -42,7 +41,7 @@ COPTS	+=	-I/usr/include/scsi -DSESINC="<ses.h>"
 .elif	${SYS} == NetBSD
 COPTS	+=	-I/usr/include/dev/scsipi -DSESINC="<ses.h>"
 .else
-COPTS	+=	-I/usr/include/cam/scsi -DSESINC="<scsi_ses.h>"
+COPTS	+=	-I/usr/include/bus/cam/scsi -DSESINC="<scsi_ses.h>"
 .endif
 BINDIR	?=	${DESTDIR}/usr/sbin
 
diff --git a/usr.bin/kdump/mkioctls b/usr.bin/kdump/mkioctls
index 9c6bc84eba..d03589b7fb 100644
--- a/usr.bin/kdump/mkioctls
+++ b/usr.bin/kdump/mkioctls
@@ -47,7 +47,7 @@ BEGIN {
 	print "#include <netinet6/nd6.h>"
 	print "#include <netinet6/ip6_mroute.h>"
 	print "#include <stdio.h>"
-	print "#include <cam/cam.h>"
+	print "#include <bus/cam/cam.h>"
 	print "#define ACPI_DEBUG_OUTPUT"
 	print "#define ACPI_APPLICATION"
 	print "#include <contrib/dev/acpica/source/include/acpi.h>"
diff --git a/usr.sbin/mfiutil/mfi_drive.c b/usr.sbin/mfiutil/mfi_drive.c
index 5dd4de26f6..31fafea57e 100644
--- a/usr.sbin/mfiutil/mfi_drive.c
+++ b/usr.sbin/mfiutil/mfi_drive.c
@@ -40,7 +40,7 @@
 #include <string.h>
 #include <strings.h>
 #include <unistd.h>
-#include <cam/scsi/scsi_all.h>
+#include <bus/cam/scsi/scsi_all.h>
 #include "mfiutil.h"
 
 MFI_TABLE(top, drive);
diff --git a/usr.sbin/mlxcontrol/interface.c b/usr.sbin/mlxcontrol/interface.c
index 0bd2d842ae..10f56f9f1b 100644
--- a/usr.sbin/mlxcontrol/interface.c
+++ b/usr.sbin/mlxcontrol/interface.c
@@ -31,7 +31,7 @@
 #include <stdlib.h>
 #include <unistd.h>
 #include <string.h>
-#include <cam/scsi/scsi_all.h>
+#include <bus/cam/scsi/scsi_all.h>
 
 #include <dev/raid/mlx/mlxio.h>
 #include <dev/raid/mlx/mlxreg.h>
diff --git a/usr.sbin/mptutil/mpt_cam.c b/usr.sbin/mptutil/mpt_cam.c
index 29af5dd07e..1578012b03 100644
--- a/usr.sbin/mptutil/mpt_cam.c
+++ b/usr.sbin/mptutil/mpt_cam.c
@@ -39,8 +39,8 @@
 #include <string.h>
 
 #include <camlib.h>
-#include <cam/scsi/scsi_message.h>
-#include <cam/scsi/scsi_pass.h>
+#include <bus/cam/scsi/scsi_message.h>
+#include <bus/cam/scsi/scsi_pass.h>
 
 #include "mptutil.h"
 
diff --git a/usr.sbin/mptutil/mpt_drive.c b/usr.sbin/mptutil/mpt_drive.c
index 15de48b58a..8597b88745 100644
--- a/usr.sbin/mptutil/mpt_drive.c
+++ b/usr.sbin/mptutil/mpt_drive.c
@@ -43,7 +43,7 @@
 #include <unistd.h>
 
 #include <camlib.h>
-#include <cam/scsi/scsi_all.h>
+#include <bus/cam/scsi/scsi_all.h>
 
 #include "mptutil.h"
 
-- 
2.23.0

